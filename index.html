<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Gerador: Etiqueta · Romaneio · Envio</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <h1>Gerador : Etiqueta · Romaneio · Envio</h1>

        <div class="grid">
            <div class="card">
                <strong>Formulário (mínimo de envio)</strong>
                <div class="small">Carregue um arquivo JSON com registros simples ou use o seletor para preencher.</div>

                <label>Remetente</label>
                <select id="sender_select">
                    <option value="ranor">Ranor Rastreamento</option>
                    <option value="nortrack">NORTRACK OPERAÇÕES LTDA</option>
                    <option value="custom">Personalizado</option>
                </select>

                <label>Empresa remetente (auto)</label>
                <input id="sender_company" type="text" readonly>

                <label>CNPJ (remetente)</label>
                <input id="sender_cnpj" type="text" readonly>

                <label>Endereço remetente (auto)</label>
                <input id="sender_address" type="text" readonly>

                <hr>

                <label>Carregar base de envio (JSON)</label>
                <div style="display:flex;gap:8px;align-items:center;">
                    <input id="file_input" type="file" accept=".json">
                    <button class="secondary" onclick="loadJsonFile()">Carregar</button>
                    <button class="secondary" onclick="clearBase()">Limpar</button>
                </div>
                <div class="small" style="margin-top:6px">Formato: array de objetos com chaves:
                    <code>destinatario,cpf_cnpj,endereco_linha1,endereco_linha2,contato</code>
                </div>

                <label>Escolher registro (base)</label>
                <select id="client_select">
                    <option value="">— nenhum —</option>
                </select>

                <hr>

                <label>Unidade (onde será feita instalação/manutenção)</label>
                <input id="unit_name" type="text" placeholder="Ex: Unilever Cabo de Santo Agostinho">

                <label>Observações (opcional)</label>
                <textarea id="obs"></textarea>

                <hr>

                <label>Destinatário (preenchido pela base ou manual)</label>
                <input id="dest_name" type="text" placeholder="">

                <div class="row">
                    <div class="col">
                        <label>CPF / CNPJ</label>
                        <input id="dest_doc" type="text" placeholder="">
                    </div>
                    <div class="col">
                        <label>Contato (opcional)</label>
                        <input id="dest_phone" type="text" placeholder="">
                    </div>
                </div>

                <label>Endereço linha 1</label>
                <input id="dest_addr1" type="text" placeholder="">

                <label>Endereço linha 2 (bairro / cidade / uf / cep)</label>
                <input id="dest_addr2" type="text" placeholder="">

                <label>Itens (descrição e qtd)</label>
                <table class="items-table" id="items_table">
                    <thead>
                        <tr>
                            <th>Descrição</th>
                            <th style="width:80px">Qtd</th>
                            <th style="width:40px"></th>
                        </tr>
                    </thead>
                    <tbody id="items_body">
                        <tr>
                            <td><input class="it-desc" value="RASTREADOR RA24"
                                    style="width:100%; border:0; outline:none"></td>
                            <td><input class="it-qty" type="number" value="1" min="1"
                                    style="width:100%; border:0; outline:none"></td>
                            <td class="center"><button type="button" onclick="removeItem(this)">✕</button></td>
                        </tr>
                    </tbody>
                </table>
                <div class="actions">
                    <button onclick="addItem()">Adicionar item</button>
                    <button class="secondary" onclick="clearItems()">Limpar itens</button>
                </div>

                <div class="row">
                    <div class="col">
                        <label>Data (chegada/assinatura - preencher manualmente)</label>
                        <input id="send_date" type="date" value="">
                    </div>
                    <div class="col">
                        <label>Volumes (nº de etiquetas)</label>
                        <input id="total_vol" type="number" value="1" min="1">
                    </div>
                </div>

                <label>Ticket/OS (referência)</label>
                <input id="reference" type="text" placeholder="Ex: 465">

                <label>Transportadora</label>
                <input id="carrier" type="text" value="Jadlog">

                <label>Recebedor/Responsável (assinatura)</label>
                <input id="receiver" type="text" value="">

                <div class="actions no-print">
                    <button onclick="generateAll()">Gerar / Atualizar</button>
                    <button class="secondary" onclick="openPreviewNewTab()">Abrir preview em nova aba</button>
                    <button class="secondary" onclick="window.print()">Imprimir</button>
                    <button class="secondary" onclick="copyEmailBody()">Copiar corpo do e-mail</button>
                    <button onclick="enviarEmail()">Enviar Email</button>
                </div>
            </div>

            <div class="card no-print">
                <strong>Ajuda / notas</strong>
                <div class="small" style="margin-top:8px">
                    - Carregue um JSON simples e selecione o registro para preencher os campos do destinatário.<br>
                    - Data do romaneio: preencha com a data de chegada/assinatura (campo em branco).<br>
                    - Para imprimir sem cortes: Abra preview em nova aba → imprimir com escala 100% e margens nenhuma.
                </div>
            </div>
        </div>

        <div class="preview-pages" id="preview"></div>
    </div>

    <script src="script.js"></script>
</body>

</html>